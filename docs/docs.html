<html>
<head>
  <title>Kanso - Documentation</title>
  <link rel="stylesheet" href="http://yandex.st/highlightjs/5.16/styles/github.min.css">
  <link rel="stylesheet" href="stylesheets/kanso.css" />
</head>
<body>
  <div id="topbar"></div>
  <div id="topbar_overlay"></div>
  <div id="container">

    <ul id="navigation">
      <li><a href="index.html">Intro</a></li>
      <li><a href="tutorial.html">Tutorial</a></li>
      <li><a class="selected" href="docs.html">Docs</a></li>
      <li><a href="https://github.com/caolan/kanso">Code &rArr;</a></li>
    </ul>

    <a id="sitename" href="index.html">
      <img src="images/kanso_ribbon.png" />
    </a>

    <!-- populated by javascript -->
    <ul id="sidenav"></ul>

    <div id="docs">
      <h1>Documentation</h1>


      <h2 id="configuration">Configuration</h2>
      <p>
        Project configuration options can be added to the <code>kanso.json</code>
        file in your project directory.
      </p>
      <ul>
        <li><strong>name</strong> (String) - the name of the design document</li>
        <li><strong>load</strong> (String) - the module to get design doc properties from</li>
        <li><strong>modules</strong> (String/Array) - files and directories to load as commonjs modules</li>
        <li><strong>templates</strong> (String) - templates directory to load templates from</li>
        <li><strong>attachments</strong> (String/Array) - files and directories to load as attachments</li>
      </ul>
      <h3>Example config</h3>
    <pre><code class="javascript">{
    "name": "myblog",
    "load": "lib/app",
    "modules": "lib",
    "templates": "templates",
    "attachments": "static"
}</code></pre>

      <h2 id="app_format">App format</h2>
      <p>
        The format of the loaded module (usually lib/app.js, depending on the "load"
        setting in kanso.json) follows the format of a CouchDB design doc. Any
        exported property of this module will be added to the design doc generated
        for your app.
      </p>
      <p>
        Kanso will occasionally extend the default design doc API by adding some
        additional properties which have a special meaning.
      </p>
      <h3 id="app_format_init">Init</h3>
      <p>
        The 'init' property is expected to be a function, and will be called on the
        initial page load, once the document is ready and the commonjs environment is
        available.
      </p>
      <p>
        This property is optional and can be safely omitted. If you want to
        progressively enhance a fallback page returned by CouchDB on the first hit,
        or initialize some application state, this is the place to do it.
      </p>
      <pre><code class="javascript">exports.init = function () {
    alert('initializing app');
};</code></pre>
      <h3 id="app_format_types">Types</h3>
      <p>
        The 'types' property is used by the admin app to find types to show in the
        applications types list. It is also assumed to be the location of any
        custom types by the skeleton app's validation function.
      </p>
      <p>
        It's a good idea to export your type definitions on this property to make
        them easy to re-use and compatible with the admin app.
      </p>
      <pre><code class="javascript">exports.types = {
    example: new Type('example', {
        fields: {
            title: fields.string(),
            message: fields.string()
        }
    })
};</code></pre>

      <h2 id="modules">Modules</h2>

      <h3 id="core">Core</h3>
      <p>
        The core module contains functions used by kanso to facilitate the running
        of your app. You shouldn't need to use any of the functions here directly
        unless you're messing with the internals of Kanso.
      </p>

      <h4 id="core_init">
        <a href="#core_init">core.init()</a>
      </h4>
      <p>
        Called by kanso.js once the design doc has been loaded.
        You should not need to call this directly.
      </p>

      <h4 id="core_rewriteGroups">
        <a href="#core_rewriteGroups">core.rewriteGroups(pattern, url)</a>
      </h4>
      <p>Extracts groups from a url, eg:</p>
      <pre>'/some/path' with pattern '/some/:name' -&gt; {name: 'path'}</pre>
      <div class="params">
        Parameters:
        <ul>
          <li>pattern (String)</li>
          <li>url (String)</li>
        </ul>
      </div>
      <div class="returns">Returns: Object</div>

    <h4 id="core_rewriteSplat">core.rewriteSplat(pattern, url)</h4>
      <p>Extracts a splat value from a rewrite pattern and matching URL.</p>
      <div class="params">
        Parameters:
        <ul>
          <li>pattern (String)</li>
          <li>url (String)</li>
        </ul>
      </div>
      <div class="returns">Returns: String</div>

      <h4 id="core_matchURL">core.matchURL(method, url)</h4>
      <p>
        Attempts to match rewrite from patterns to a URL, returning the
        matching rewrite object if successful.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>method (String)</li>
          <li>url (String)</li>
        </ul>
      </div>
      <div class="returns">Returns: Object</div>

      <h4 id="core_replaceGroups">core.replaceGroups(val, groups, splat)</h4>
      <p>
        Replace group names and splats in a string with the value of that group
        or splat, eg:
      </p>
      <pre>"/:name" with groups {name: 'test'} -&gt; "/test"</pre>
      <div class="params">
        Parameters:
        <ul>
          <li>val (String)</li>
          <li>groups (Object)</li>
          <li>splat (String)</li>
        </ul>
      </div>
      <div class="returns">Returns: String</div>

      <h4 id="core_createRequest">
        core.createRequest(method, url, data, match, callback)
      </h4>
      <p>
        Creates a new request object from a url and matching rewrite object.
        Query parameters are automatically populated from rewrite pattern.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>method (String)</li>
          <li>url (String)</li>
          <li>data (Object)</li>
          <li>match (Object)</li>
          <li>callback (Function)</li>
        </ul>
      </div>
      <div class="returns">Returns via callback: Request Object</div>

      <h4 id="core_runShowBrowser">
        core.runShowBrowser(req, name, docid, callback)
      </h4>
      <p>
        Fetches the relevant document and calls the named show function.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>req (Object)</li>
          <li>name (String)</li>
          <li>docid (String)</li>
          <li>callback (Function)</li>
        </ul>
      </div>

      <h4 id="core_runUpdateBrowser">
        core.runUpdateBrowser(req, name, docid, callback)
      </h4>
      <p>
        Fetches the relevant document and calls the named update function.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>req (Object)</li>
          <li>name (String)</li>
          <li>docid (String)</li>
          <li>callback (Function)</li>
        </ul>
      </div>

      <h4 id="core_createHead">core.createHead(data)</h4>
      <p>
        Creates a fake head object from view results for passing to a list function
        being run client-side.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>data (Object)</li>
        </ul>
      </div>
      <div class="returns">Returns: Object</div>

      <h4 id="core_runListBrowser">
        core.runListBrowser(req, name, view, callback)
      </h4>
      <p>
        Fetches the relevant view and calls the named list function with the results.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>req (Object)</li>
          <li>name (String)</li>
          <li>view (String)</li>
          <li>callback (Function)</li>
        </ul>
      </div>

      <h4 id="core_handle">
        core.handle(method, url, data)
      </h4>
      <p>
        Creates a request object for the url and runs appropriate show, list or
        update functions.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>method (String)</li>
          <li>url (String)</li>
          <li>data (Object)</li>
        </ul>
      </div>

      <h4 id="core_setURL">
        core.setURL(method, url, data, hash)
      </h4>
      <p>
        Add a history entry for the given url, prefixed with the baseURL for the app.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>method (String)</li>
          <li>url (String)</li>
          <li>data (optional) (Object)</li>
          <li>hash (optional) (String)</li>
        </ul>
      </div>

      <h4 id="core_getURL">
        core.getURL()
      </h4>
      <p>
        Gets the current app-level URL (without baseURL prefix).
      </p>
      <div class="returns">Returns: String</div>

      <h4 id="core_sameOrigin">
        core.sameOrigin(a, b)
      </h4>
      <p>
        Tests is two urls are of the same origin. Accepts parsed url objects
        or strings as arguments.
      </p>
      <div class="returns">Returns: Boolean</div>

      <h4 id="core_appPath">
        core.appPath(p)
      </h4>
      <p>
        Converts a full url to an app-level url (without baseURL prefix).
        example: {baseURL}/some/path -&gt; /some/path
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>p (String)</li>
        </ul>
      </div>
      <div class="returns">Returns: String</div>

      <h4 id="core_isAppURL">
        core.isAppURL(url)
      </h4>
      <p>
        Used to decide whether to handle a link or not. Should detect app vs.
        external urls.
      </p>
      <div class="params">
        Parameters:
        <ul>
          <li>url (String)</li>
        </ul>
      </div>
      <div class="returns">Returns: Boolean</div>

      <h2 id="commands">Commands</h2>
      <p>
        Typing 'kanso' with no arguments will present you with a list of available
        commands. More information can be found by typing 'kanso help' optionally
        followed by the name of the command you need help with.
      </p>

      <h3 id="push">Push</h3>
      <p>Upload a project to a CouchDB instance.</p>
      <pre>kanso push [OPTIONS] DB [PATH]

  Parameters:
    DB     The CouchDB instance to upload the app to
    PATH   The project path to load the app from

  Options:
    --minify               Compress CommonJS modules using UglifyJS
    --minify-attachments   Compress .js attachments
    --baseURL PATH         Force the baseURL to a specific value.
                           (allows vhosts on CouchDB &lt; v1.1.x)
  </pre>

      <h3 id="pushdata">Pushdata</h3>
      <p>Push a file or directory of JSON files to DB.</p>
      <pre>kanso pushdata [OPTIONS] DB PATH

  Parameters:
    DB     The CouchDB instance to upload the documents to
    PATH   A file or directory containing JSON documents to upload

  Options:
    -f, --force      Ignore document conflict errors and upload anyway
  </pre>

      <h3 id="pushadmin">Pushadmin</h3>
      <p>Upload the kanso admin app to a CouchDB instance.</p>
      <pre>kanso pushadmin [OPTIONS] DB

Parameters:
  DB     The CouchDB instance to upload the app to

Options:
  --minify               Compress CommonJS modules using UglifyJS
  --minify-attachments   Compress .js attachments
  --baseURL PATH         Force the baseURL to a specific value.
                         (allows vhosts on CouchDB < v1.1.x)
</pre>

      <h3 id="create">Create</h3>
      <p>Create a new project skeleton.</p>
      <pre>kanso create PATH

  Parameters:
    PATH     Path to create a new project skeleton at, project name
             defaults to last directory in this path
  </pre>

      <h3 id="help">Help</h3>
      <p>Show help specific to a command.</p>
      <pre>kanso help [COMMAND]

  Parameters:
    COMMAND      The kanso command to show help on
  </pre>

      <h3 id="show">Show</h3>
      <p>Load a project and output resulting JSON</p>
      <pre>kanso show [PATH]

  Parameters:
    PATH     Path to project directory to show (defaults to ".")
  </pre>

      <h3 id="uuids">UUIDs</h3>
      <p>Returns UUIDs generated by a CouchDB instance.<p>
      <pre>kanso uuids [OPTIONS] [URL]

  Parameters:
    URL         The CouchDB instance to generate UUIDs from
                (defaults to http://localhost:5984)

  Options:
    -n [NUM], --number [NUM]    The number of UUIDs to generate (default: 1)
  </pre>

    </div>
  </div>

  <script src="http://yandex.st/highlightjs/5.16/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script src="javascript/docs.js"></script>
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-20477836-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</body>
</html>
